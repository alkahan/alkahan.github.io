<!DOCTYPE html>
<html lang="fr">

    <head><title>Améliorer la détection de ClamAV &ndash; Blog de Alkahan</title>
<meta name="description" content="Blog d&#39;un admin système et utilisateur Linux depuis Redhat 5.2 (pas RHEL 5.2).">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8"/>



<link rel="stylesheet" href="http://blog.alkahan.net/css/colour/gruvbox-dark.css">
<link rel="stylesheet" href="http://blog.alkahan.net/css/colour/dark-mode.css">
<link rel="stylesheet" href="http://blog.alkahan.net/css/risotto.css">
<link rel="stylesheet" href="http://blog.alkahan.net/css/custom.css">
</head>

    <body>
        <div class="page">

            <header class="page__header"><h1 class="page__logo"><a href="http://blog.alkahan.net/" class="page__logo-inner">Blog de Alkahan</a></h1>
<nav class="page__nav main-nav">
    <ul>
    
    
    <li class="main-nav__item"><a class="nav-main-item" href="/about/" title="">About</a></li>
    
    <li class="main-nav__item"><a class="nav-main-item active" href="/post/" title="Posts">Posts</a></li>
    
    </ul>
</nav>

</header>

            <section class="page__body">
    <header class="content__header">
        <h1>Améliorer la détection de ClamAV</h1>
    </header>
    <div class="content__body">
        <p>ClamAV est le seul Antivirus Open Source sur le marché, et l&rsquo;un des rares qui
fonctionne bien sous Linux.  Il a l&rsquo;avantage d&rsquo;être livré en standard avec la
plupart des distributions du marché, et sa mise à jour est simple aussi bien
pour le moteur et pour les règles.</p>
<p>Le moteur de ClamAV fonctionne plutôt bien mais le logiciel peut paraitre en
retrait dans la détection des malwares par rapport à certains acteurs du marché.</p>
<p>Il existe plusieurs méthodes de détection dans les antivirus, mais celle qui est
la plus utilisée et qui obtient les meilleurs résultats est la détection par
signature. Et c&rsquo;est la base des signatures qui différencie les antivirus entre
eux. Et c&rsquo;est ce point que je propose d&rsquo;améliorer.</p>
<p>Voici les informations extraites de la commande clamconf des bases livrées par défaut.</p>
<pre tabindex="0"><code>daily.cld: version 22646, sigs: 962997, built on Sat Dec  3 04:29:03 2016
bytecode.cld: version 285, sigs: 57, built on Wed Nov 16 20:41:30 2016
main.cvd: version 57, sigs: 4218790, built on Thu Mar 17 00:17:06 2016 
</code></pre><p>Cela nous fait un total de 962 997 + 57 + 4 218 790 = 5 181 844 signatures.</p>
<p>Pour ma part je complète ces signatures à l&rsquo;aide du script
<a href="https://github.com/extremeshok/clamav-unofficial-sigs/">clamav-unofficial-sigs</a></p>
<p>Voici, une fois installé les inforamtions des bases :</p>
<pre tabindex="0"><code>Database information
--------------------
Database directory: /var/lib/clamav
[3rd Party] phish.ndb: 26511 sigs
daily.cld: version 22646, sigs: 962997, built on Sat Dec  3 04:29:03 2016
[3rd Party] securiteinfo.hdb: 720513 sigs
[3rd Party] EK_Zerox88.yar: 55 sigs
[3rd Party] winnow_malware.yara: 107 sigs
bytecode.cld: version 285, sigs: 57, built on Wed Nov 16 20:41:30 2016
[3rd Party] bofhland_malware_attach.hdb: 1810 sigs
[3rd Party] EK_Phoenix.yar: 483 sigs
[3rd Party] porcupine.hsb: 658 sigs
[3rd Party] porcupine.ndb: 2980 sigs
[3rd Party] winnow_extended_malware.hdb: 1640 sigs
[3rd Party] EK_BleedingLife.yar: 112 sigs
[3rd Party] winnow.attachments.hdb: 5894 sigs
[3rd Party] winnow_bad_cw.hdb: 1 sig 
[3rd Party] EK_ZeroAcces.yar: 211 sigs
[3rd Party] EK_Fragus.yar: 210 sigs
[3rd Party] sanesecurity.ftm: 170 sigs
[3rd Party] Sanesecurity_sigtest.yara: 54 sigs
[3rd Party] foxhole_generic.cdb: 193 sigs
[3rd Party] crdfam.clamav.hdb: 5000 sigs
[3rd Party] phishtank.ndb: 27528 sigs
[3rd Party] scamnailer.ndb: 47879 sigs
[3rd Party] spamattach.hdb: 12 sigs
[3rd Party] securiteinfopdf.hdb: 586 sigs
[3rd Party] blurl.ndb: 1838 sigs
safebrowsing.cld: version 45303, sigs: 2503013, built on Sat Dec  3 06:50:58 2016
[3rd Party] EK_Sakura.yar: 62 sigs
[3rd Party] bofhland_malware_URL.ndb: 354 sigs
[3rd Party] EK_Zeus.yar: 28 sigs
[3rd Party] Sanesecurity_spam.yara: 46 sigs
main.cvd: version 57, sigs: 4218790, built on Thu Mar 17 00:17:06 2016
[3rd Party] javascript.ndb: 71248 sigs
[3rd Party] EK_Eleonore.yar: 165 sigs
[3rd Party] antidebug_antivm.yar: 1812 sigs
[3rd Party] hackingteam.hsb: 435 sigs
[3rd Party] EK_Angler.yar: 283 sigs
[3rd Party] scam.ndb: 12434 sigs
[3rd Party] EK_Crimepack.yar: 49 sigs
[3rd Party] EK_Blackhole.yar: 453 sigs
[3rd Party] rfxn.ndb: 1918 sigs
[3rd Party] securiteinfohtml.hdb: 194935 sigs
[3rd Party] winnow_malware.hdb: 4229 sigs
[3rd Party] EMAIL_Cryptowall.yar: 52 sigs
[3rd Party] jurlbl.ndb: 6549 sigs
[3rd Party] rfxn.hdb: 8907 sigs
[3rd Party] bofhland_cracked_URL.ndb: 44 sigs
[3rd Party] foxhole_filename.cdb: 869 sigs
[3rd Party] spamimg.hdb: 59 sigs
[3rd Party] rogue.hdb: 3962 sigs
[3rd Party] winnow_malware_links.ndb: 12916 sigs
[3rd Party] junk.ndb: 54614 sigs
[3rd Party] bofhland_phishing_URL.ndb: 162 sigs
[3rd Party] securiteinfoascii.hdb: 56434 sigs
[3rd Party] malwarehash.hsb: 188 sigs
Total number of signatures: 8962509
</code></pre><p>Comme vous l&rsquo;aurez remarqué, le nombre de signature passe de 5 181 844 à 8 962 509 !</p>
<p>A l&rsquo;usage j&rsquo;ai remarqué une meilleure détection des malwares PHP sur les
serveurs ainsi que pour les e-mails.</p>
<p>Notez que dans les bases de signatures que le script gère, certaines nécessitent une
inscription, gratuite ou payante.</p>
    </div>
    <footer class="content__footer"></footer>

            </section>

            <section class="page__aside">
                <div class="aside__about">
<div class="aside__about">
    <img class="about__logo" src="http://blog.alkahan.net/images/rice.svg" alt="Logo">
<h1 class="about__title">Blog de Alkahan</h1>
<p class="about__description">Blog d&rsquo;un admin système et utilisateur Linux depuis Redhat 5.2 (pas RHEL 5.2).</p>
</div>


<ul class="aside__social-links">
    
</ul>
</div>
                <hr>
                <div class="aside__content">
    
    
        <p>
            
            2016-12-02
        </p>
    

                </div>
            </section>

            <footer class="page__footer"><p class="copyright"></p>
<p class="advertisement">Powered by <a href="https://gohugo.io/">hugo</a> and <a href="https://github.com/joeroe/risotto">risotto</a>.</p>
</footer>

        </div>
    </body>

</html>
